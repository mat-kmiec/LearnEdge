<!DOCTYPE html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>LearnEdge - Logowanie</title>
    <link rel="icon" type="image/x-icon" th:href="@{/img/favicon.ico}" href="../../static/img/favicon.ico"/>

    <!-- Bootstrap CSS -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />

    <!-- Bootstrap Icons -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
            rel="stylesheet"
    />

    <!-- Custom -->
    <link th:href="@{/css/pages/auth.css}" href="../../static/css/pages/auth.css" rel="stylesheet"/>
</head>
<body>
<main>
    <section class="card p-4 shadow">
        <header class="text-center mb-4">
            <a th:href="@{/}" href="/" class="text-decoration-none text-reset d-inline-block">
                <img th:src="@{/img/logo-icon.png}"
                     src="../../static/img/logo-icon.png"
                     alt="Logo aplikacji"
                     width="64"
                     height="64"
                     class="mb-3">
                <h1 class="h4 fw-bold brand-gradient m-0">LearnEdge</h1>
            </a>

        </header>

        <!-- Komunikaty o błędach / wylogowaniu -->
        <div th:if="${param.error}" class="alert alert-danger py-2">Nieprawidłowy login lub hasło.</div>
        <div th:if="${param.logout}" class="alert alert-success py-2">Wylogowano pomyślnie.</div>

        <form th:action="@{/login}" method="post" novalidate aria-label="Formularz logowania">
            <!-- CSRF token -->
            <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="floatingInput" name="username"
                       placeholder="nazwa@google.com" autocomplete="username" required>
                <label for="floatingInput">E-mail</label>
            </div>

            <div class="form-floating mb-3 position-relative">
                <input type="password" class="form-control" id="floatingPassword" name="password"
                       placeholder="Hasło" autocomplete="current-password" required>
                <label for="floatingPassword">Hasło</label>
                <button class="btn btn-link position-absolute end-0 top-50 translate-middle-y" 
                        type="button" 
                        onclick="togglePasswordVisibility('floatingPassword')"
                        style="z-index: 10; text-decoration: none;">
                    <i class="bi bi-eye" id="floatingPassword-icon"></i>
                </button>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-4">
                <div class="form-check">
                    <input type="checkbox" id="remember" name="remember-me" class="form-check-input">
                    <label for="remember" class="form-check-label">Zapamiętaj mnie</label>
                </div>
                <a th:href="@{/przypomnij-haslo}" href="#" class="small text-decoration-none">Zapomniałeś hasła?</a>
            </div>

            <button type="submit" class="btn btn-gradient w-100 mb-3">Zaloguj się</button>

            <div class="d-flex justify-content-center">
                <p class="text-muted mb-2">Zaloguj się przez:</p>
            </div>

            <div class="d-flex justify-content-center">
                <a class="btn" th:href="@{/oauth2/authorization/google}" type="button">
                    <i class="bi bi-google me-2 google-icon fs-3"></i>
                </a>
                <a class="btn" th:href="@{/oauth2/authorization/github}" type="button">
                    <i class="bi bi-github me-2 text-dark fs-3"></i>
                </a>
            </div>
        </form>

        <footer class="text-center mt-4">
            <p class="small mb-0">Nie masz konta?
                <a th:href="@{/rejestracja}" href="#" class="text-decoration-none fw-semibold">Zarejestruj się</a>
            </p>
        </footer>
    </section>
</main>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    function togglePasswordVisibility(fieldId) {
        const input = document.getElementById(fieldId);
        const icon = document.getElementById(fieldId + '-icon');
        
        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('bi-eye');
            icon.classList.add('bi-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('bi-eye-slash');
            icon.classList.add('bi-eye');
        }
    }
</script>
</body>
</html>
